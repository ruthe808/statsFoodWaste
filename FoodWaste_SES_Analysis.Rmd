---
title: "Food Waste SES Analysis"
author: "Ruth Enriquez"
date: "2022-12-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#loading in libraries
library(here)
library(tidyverse)
library(janitor)
library(readxl)
library(dplyr)
library(ggplot2)
```

```{r}
#loading in data

#loading food waste data on wholesale and retail 
foodRaw <- read_excel(here("data", "foodWaste", "Food_Wholesale_Retail.xlsx"), sheet = "Data") |> 
  clean_names() |> 
  mutate(excessfood_tonyear_lowest = as.numeric(excessfood_tonyear_lowest), excessfood_tonyear_highest = as.numeric(excessfood_tonyear_highest)) |> 
  filter(is.na(excessfood_tonyear_lowest) == FALSE, is.na(excessfood_tonyear_highest) == FALSE, county != "NULL")


#loading in county census data
Census <- read_excel(here("data", "census2020.xlsx"), sheet = "Data2") |> 
  clean_names()

```

```{r}
#cleaning up foodRaw data
food <- foodRaw |> 
  select("county", "state", "excessfood_tonyear_lowest", "excessfood_tonyear_highest") |> 
  filter(state == "CA") |> 
  group_by(county) |> 
  summarise(Mean_Food_Waste_Low = mean(excessfood_tonyear_lowest), Mean_Food_Waste_High = mean(excessfood_tonyear_highest))
```


```{r}
#joining the food and census tables together
foodCensus <- left_join(Census, food, by = "county") |> 
  select("county",
         "mean_household_income_dollars",
         "Mean_Food_Waste_Low",
         "Mean_Food_Waste_High")
```


```{r}
#checking my data distribution
incomeHist <- hist(foodCensus$mean_household_income_dollars)

lowHist <- hist(foodCensus$Mean_Food_Waste_Low)

highHist <- hist(foodCensus$Mean_Food_Waste_High)

```


```{r}
#seeing if there is a relationship between average household income and average food waste produced
lowWaste <- ggplot(data = foodCensus,
                            aes(x = mean_household_income_dollars,
                                y = Mean_Food_Waste_Low)) +
  geom_point(size = 3) +
  theme_classic()

highWaste <- ggplot(data = foodCensus,
                            aes(x = mean_household_income_dollars,
                                y = Mean_Food_Waste_High)) +
  geom_point(size = 3) +
  theme_classic()

lowWaste
highWaste
```




```{r}

regLow <-lm(Mean_Food_Waste_Low ~ mean_household_income_dollars, data =foodCensus)
regHigh <-lm(Mean_Food_Waste_High ~ mean_household_income_dollars, data =foodCensus)

summary(regLow)
summary(regHigh)
```


```{r}
lowWastePlot <- ggplot(data = foodCensus, aes(x = Mean_Food_Waste_Low, y = mean_household_income_dollars)) + 
  geom_point(alpha = 0.1, size = 3) + 
  geom_smooth(method ='lm', formula = y~x, color ="lightcoral", se = F, size = 1.5) +
  theme_bw()

highWastePlot <- ggplot(data = foodCensus, aes(x = Mean_Food_Waste_High, y = mean_household_income_dollars)) + 
  geom_point(alpha = 0.1, size = 3) + 
  geom_smooth(method ='lm', formula = y~x, color ="lightcoral", se = F, size = 1.5) +
  theme_bw()

lowWastePlot
highWastePlot
```

```{r}
#loading in county census data
region <- read_excel(here("data", "countyRegion.xlsx"))

#adding regional data to foodCensus table
foodRegion<- left_join(foodCensus, region, by = "county") |> 
  group_by(Region) |> 
  summarise(Mean_Income = mean(mean_household_income_dollars), Mean_Food_Waste_Low = mean(Mean_Food_Waste_Low), Mean_Food_Waste_High = mean(Mean_Food_Waste_High))

```

a.  State your null and alternative hypotheses

$$H_{0}: \mu_{northCentralForst} - \mu_{southFrost} = 0$$ $$H_{A}: \mu_{northCentralFrost} - \mu_{southFrost} \neq 0$$

```{r}

```


