---
title: "Food Waste SES Analysis"
author: "Ruth Enriquez"
date: "2022-12-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
#loading in libraries
library(here)
library(tidyverse)
library(janitor)
library(readxl)
library(dplyr)
library(ggplot2)
```

```{r}
#loading in data

#loading restaurant and food service data part 1
foodRaw <- read_excel(here("data", "foodWaste", "Food_Wholesale_Retail.xlsx"), sheet = "Data") |> 
  clean_names() |> 
  mutate(excessfood_tonyear_lowest = as.numeric(excessfood_tonyear_lowest), excessfood_tonyear_highest = as.numeric(excessfood_tonyear_highest)) |> 
  filter(is.na(excessfood_tonyear_lowest) == FALSE, is.na(excessfood_tonyear_highest) == FALSE, county != "NULL")


#loading census data
Census <- read_excel(here("data", "census2020.xlsx"), sheet = "Data2") |> 
  clean_names()
```

```{r}
#cleaning up foodRaw data
food <- foodRaw |> 
  select("county", "state", "excessfood_tonyear_lowest", "excessfood_tonyear_highest") |> 
  filter(state == "CA") |> 
  group_by(county) |> 
  summarise(Total_ExcessFood_Lowest_2020 = sum(excessfood_tonyear_lowest), Total_ExcessFood_Highest_2020 = sum(excessfood_tonyear_highest))
```

```{r}
#joining the food and census tables together
foodCensus <- left_join(Census, food, by = "county") |> 
  mutate(Average_ExcessFood_2020 = ((Total_ExcessFood_Lowest_2020 + Total_ExcessFood_Highest_2020)/2))
```

```{r}
#seeing if there is a relationship between average household income and average food waste produced

income_waste_plot <- ggplot(data = foodCensus,
                            aes(x = mean_household_income_dollars, y = Average_ExcessFood_2020)) +
  geom_point(size = 3) +
  theme_classic() +
  ylim(0, 180000) +
  geom_hline(yintercept = sum(foodCensus$Average_ExcessFood_2020), color = "blue")

income_waste_plot
  
```

```{r}
#seeing what log does

income_waste_plot <- ggplot(data = foodCensus,
                            aes(x = mean_household_income_dollars, y = log(Average_ExcessFood_2020))) +
  geom_point(size = 3) +
  theme_classic() +
  geom_hline(yintercept = log(sum(foodCensus$Average_ExcessFood_2020)), color = "blue")

income_waste_plot
```

